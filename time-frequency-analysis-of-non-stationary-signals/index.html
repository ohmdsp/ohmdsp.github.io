<!doctype html><html lang=en-us><head><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover"><meta charset=utf-8><meta name=generator content="Hugo 0.123.7 with Arberia theme"><title>OhmDSP Site | Time-Frequency Analysis of Non-Stationary Signals</title>
<link rel=canonical href=https://ohmdsp.github.io/time-frequency-analysis-of-non-stationary-signals/><meta name=description content="Descrizione da rivedere se è un doppione subtitle"><meta name=author content><meta name=keywords content><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebPage","headline":"Time-Frequency Analysis of Non-Stationary Signals","datePublished":"2021-04-19T19:57:40+08:00","dateModified":"2021-04-19T19:57:40+08:00","url":"https://ohmdsp.github.io/time-frequency-analysis-of-non-stationary-signals/","description":"Descrizione da rivedere se è un doppione subtitle","keywords":["time-frequency-analysis","DSP","non-stationary"],"mainEntityOfPage":{"@type":"WebPage","@id":"https://ohmdsp.github.io/"},"publisher":{"@type":"Organization","name":"OhmDSP Site","url":"https://ohmdsp.github.io/"}}</script><link rel=icon href=../favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=../favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=../favicon/favicon-32x32.png><link rel=apple-touch-icon href=../favicon/apple-touch-icon.png><link rel=mask-icon href=../favicon/safari-pinned-tab.svg><link rel=manifest href=../site.webmanifest><meta name=theme-color content="/"><meta name=msapplication-TileColor content="/"><link rel=stylesheet type=text/css href=../lib/bootstrap/css/bootstrap.min.css><link rel=stylesheet type=text/css href=../lib/lightbox/css/lightbox.css><link rel=stylesheet type=text/css href=../font-awesome-4.7.0/css/font-awesome.min.css><link rel=stylesheet type=text/css href=../gfonts/font.css><link rel=stylesheet href=https://ohmdsp.github.io/main.min.cd0e89a060caa38dbb22a636944f6f5546d4650fcb33393f71de3295fd988348.css><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]]},options:{skipHtmlTags:["script","noscript","style","textarea","pre","code"],processHtmlClass:"mathjax",ignoreHtmlClass:"no-mathjax"}}</script><script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body><nav class="navbar fixed-top navbar-expand-lg navbar-dark flex-column"><div class="container flex-row"><style>.navbar-brand{color:#fff!important;font-weight:700!important}</style><button class="navbar-toggler mr-3" type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse navbar-nav-scroll" id=navbarSupportedContent role=navigation aria-label="Main Navigation"><ul class="navbar-nav mr-5 flex-fill"><li class=nav-item><a class=nav-link href=../posts/>OhmDSP Blog</a></li><li class=nav-item><a class=nav-link href=../about/>About</a></li></ul><div class="collapse navbar-collapse navbar-nav-scroll" id=navbarSupportedContent role=navigation aria-label="Main Navigation"><div class="d-block d-lg-none"><ul class=navbar-nav><li class=nav-item><a class=nav-link href=../search title=Search><span class="d-block d-lg-none"><i class="fa fa-search" aria-hidden=true></i> Search</span><span class="d-none d-lg-block"><i class="fa fa-search" aria-hidden=true></i></span></a></li></ul></div><div class="d-none d-lg-flex align-items-center mr-2 flex-fill"><form class="form-inline ml-0" action=../search method=GET target=_self><a class="js-search-form-submit position-absolute" href=../search title=Search><i class="fa fa-search fa-fw text-muted pl-2" aria-hidden=true></i></a>
<input id=search-by class="search-field form-control form-control-md mr-sm-1 mr-lg-2 w-100" style=padding-left:2rem maxlength=50 data-search-input type=search placeholder=Search aria-label=Search name=q>
<input type=hidden name=_from value=nav></form></div></div></div></nav><div class="container main-content"><div class="row justify-content-center"><div class="col-md-10 col-lg-8 article"><div class="article-body page-body"><h1 class=text-center id=post-title>Time-Frequency Analysis of Non-Stationary Signals<a class=headerlink href=../time-frequency-analysis-of-non-stationary-signals/ title="Permanent link"></a></h1><p class="text-center text-muted">Bat Chrip Signal Analysis</p><picture><source media=(min-width:480px) srcset=../time-frequency-analysis-of-non-stationary-signals/bat-tf_huc05746d36f58fcc0da0e83fb496991fe_59070_960x0_resize_q75_h2_box_2.webp type=image/webp><source srcset=../time-frequency-analysis-of-non-stationary-signals/bat-tf_huc05746d36f58fcc0da0e83fb496991fe_59070_480x0_resize_q75_h2_box_2.webp type=image/webp><img loading=lazy class="img-fluid mx-auto d-block rounded mb-4" src=../time-frequency-analysis-of-non-stationary-signals/bat-tf.webp height=1080 width=1920 type=image/webp alt=bat-tf.webp></picture><div class="row mb-1"><div class="col-2 col-md-1 p-0 ml-3 align-self-center"><a href><img src class="rounded-circle img-fluid w-100" sizes=10vw alt></a></div><div class="col pr-0 d-flex align-items-center"><p><span class=text-muted><span class=mr-2><a class=text-muted href target=_blank></a></span><br><span class="fa fa-clock-o"></span> <time>Apr 19, 2021</time>
<span class="ml-2 fa fa-tags" aria-hidden=true></span>
<a class="badge badge-light text-muted" href=../tags/time-frequency-analysis/>Time-Frequency-Analysis</a>
<span class="ml-2 fa fa-tags" aria-hidden=true></span>
<a class="badge badge-light text-muted" href=../tags/dsp/>DSP</a>
<span class="ml-2 fa fa-tags" aria-hidden=true></span>
<a class="badge badge-light text-muted" href=../tags/non-stationary/>Non-Stationary</a></span></p></div></div><p>Check out the <a href=https://github.com/ohmdsp/TF-Bat-Signal-Analysis>Matlab demo code</a> to explore time-frequency analysis using a Bat signal&mldr;not the super-hero one.</p><p>Often, the examples provided in our signal processing textbooks assume that the signal we are working with is wide-sense-stationary. This means that the first and second order statistics (mean and correlation) do not change with shifts in time. Although, all of our statistical signal processing techniques depend upon this statistical behavior in order to produce meaningful characterizations when analyzing a random signal, many real-world signals don&rsquo;t have nonstationary characteristics. A bat echo-location signal is just one example.</p><p>How can we use statistical signal processing techniques to analyze time-changing statistical behavior? We must first determine what is the longest time interval $N$ over which we can assume that the data is approximately stationary, and then step through the random signal (with or without data overlap) using small analysis intervals never exceeding $N$. This is done to accurately capture the quasi-stationary statistical characteristics for each analysis interval. The changing statistical behavior may then be tracked by creating a stacked plot of the statistics estimated each analysis interval. This plot is called a time-vs-frequency spectrogram (Note: other types of time-vs-feature grams are also possible, but not discussed here).</p><h2 id=frequency-domain-analysis>Frequency-Domain Analysis</h2><p>If the autocorrelation sequence (ACS) for a signal is stationary, then the Fourier transform of the ACS (the power spectral density, or PSD) is also stationary. A way to visualize this is to look at the shape of the plotted PSD or the ACS. If the signal is stationary, these plotted shapes should not change over time. If time varying content is observed, then the random signal has nonstationary statistical behavior. We could experimentally vary the analysis interval duration $N$ until differences in successive PSD estimates are observed, indicating the threshold between quasi-stationary and nonstationary statistical behavior.</p><p>Using bat echo-location data, an experimental determination was made that $ N = 38 $ samples was the threshold between quasi-stationary and stationary statistical behavior. The time-vs-frequency gram created by using a sample spectrum (magnitude of FFT) for each analysis intervals of 38 samples, with 37 sample overlap (i.e., only one sample shift), is shown in the figure below. Notice the four separate signal components being generated simultaneously by the bat during echo-location.</p><figure style=text-align:center><img src=bat-tf.webp alt="Bat spectrogram" style=width:690px><figcaption><em>Fig 1. TF analysis of a bat echo-location signal.</em></figcaption></figure><p>The bat data has an approximately linear time-vs-frequency trajectory in the TF analysis gram that makes it possible to calculate an approximation for the longest time interval in which the bat signal can be considered to be quasi-stationary. The Fourier transform of a windowed data segment of duration $ NT $ seconds (where $ N $ is the number of data points and $ T $ is the sampling interval) produces a frequency domain spectrum mainlobe response which is roughly $ 1/NT $ Hz in 3dB bandwidth. Therefore, a criterion for having a roughly stationary statistical behavior is that any change in frequency content be less than $ 1/NT $ Hz over an analysis interval, as this is not resolvable. If this can be made true, the signal is considered to be quasi-stationary over the analysis interval of $ N $ samples. From examining the bat spectrogram, we can see there is an approximately linear change of frequency vs time from 50 KHz at 0.65ms to 32 KHz at 1.8 ms. The slope in this region is $ s=(50-32)/(1.8-0.65)=15.65 $ KHz/ms. Thus, if $ NT $ is expressed in ms, the change in frequency is $ sNT $ KHz. We want this to be less than the mainlobe response bandwidth. So, the threshold between quasi-stationary and nonstationary conditions is approximately $ sNT = 1/NT $. Since the bat data was sampled at $ T = 7 $ microseconds, solving for $ N^2=1/sT^2 $ yields $ N = 36.1 $ samples, which compares well with our experimentally determined value of $ N=38 $.</p><p>Try some of these parameter changes to explore what happens:</p><ul><li>Change the FTT size (example - 64 samples, or 2048 samples)</li><li>Change the analysis interval duration (example - 8 samples or 256 samples)</li><li>Change the overlap sample size (example - make same as analysis interval duration, try $1/2$ that size)</li><li>Make notes on what changes while you experiment<br></li></ul><h3 id=resources>Resources</h3><ul><li>Don&rsquo;t forget to download the code and bat signal data so you can try for yourself - <a href=https://github.com/ohmdsp/Bat_Signal_TF_Analysis>Code & Bat Data</a></li></ul><p><em>Thanks to Dr. Larry Marple Jr. for the introduction to time-frequency analysis back when I was in graduate school. Please check out Larry&rsquo;s well-known book on <a href=https://www.amazon.com/Digital-Spectral-Analysis-Electrical-Engineering/dp/048678052X>Spectral Analysis</a></em></p></div></div></div></div><footer class=footer><div class=container><p class="small text-center text-muted w-75 mx-auto">&copy 2012–2025 OhmDSP Site&nbsp;⋅
<a href=../contact>Contact</a>&nbsp;</div></footer><script type=text/javascript src=../lib/jquery/jquery.js></script><script type=text/javascript src=../lib/popper/popper.js></script><script type=text/javascript src=../lib/bootstrap/js/bootstrap.min.js></script><script type=text/javascript src=../lib/lightbox/js/lightbox.js></script><script>var lightbox=GLightbox(),lightboxDescription,lightboxVideo,lightboxInlineIframe;lightbox.on("open",e=>{console.log("lightbox opened")}),lightboxDescription=GLightbox({selector:".glightbox2"}),lightboxVideo=GLightbox({selector:".glightbox3"}),lightboxVideo.on("slide_changed",({prev:e,current:t})=>{console.log("Prev slide",e),console.log("Current slide",t);const{slideIndex:s,slideNode:o,slideConfig:i,player:n}=t;n&&(n.ready||n.on("ready",e=>{}),n.on("play",e=>{console.log("Started play")}),n.on("volumechange",e=>{console.log("Volume change")}),n.on("ended",e=>{console.log("Video ended")}))}),lightboxInlineIframe=GLightbox({selector:".glightbox4"})</script><script type=text/javascript src=../lib/back-to-top/vanilla-back-to-top.min.js></script><script>addBackToTop({diameter:56,backgroundColor:"rgb(255, 82, 82)",textColor:"#fff"})</script></body></html>